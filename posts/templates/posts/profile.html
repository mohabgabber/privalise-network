{% extends 'posts/base.html' %}
{% load post_extras %}
{% block title %}@{{ user.username }} Profile, On Privalise!{% endblock title %}
{% block content %}
<center class="w-auto mx-auto profile">
	<div class="vstack gap-1 mx-auto d-flex align-items-center justify-content-center">
		<div class="picture-container mx-auto d-block">
			<img class="profile-picture img-fluid w-100" src="{{ user.profile.image.url }}">
		</div>
		<h2 class="account-heading">@{{ user.username }}</h2>
		<div class="hstack mx-auto">
			{% if request.user == user %}
	            <a href="{% url 'profile-update' %}">
	           	<button type="button" style="margin-left: 11px;" class="btn btn-outline-info">
		           Settings
	            </button></a>
	        {% else %}
	            {% if is_following == False %}
			        <form method="POST" action='{% url "add-follower" user.username %}'>
			            {% csrf_token %}
				        <button type="submit" style="margin-left: 21px;" class="btn btn-outline-danger">Follow</button>
			        </form>
	            {% else %}
		            <form method="POST" action='{% url "remove-follower" user.username %}'>
			            {% csrf_token %}
		                <button type="submit" style="margin-left: 21px;"  class="btn btn-outline-danger">UnFollow</button>
		            </form>
	            {% endif %}
	        {% endif %}
	        <a href="#hashLink" style="margin-left: 8px; margin-right: 8px;" class="btn btn-outline-danger"><i class="fas fa-user-secret"></i></a>
	    </div>
	</div>
</center>
<div>
	<p id="hashLink">
	    Name: {% if user.profile.name == '' %}NO NAME{% else %}{{user.profile.name}}{% endif %}<br>
	    Monero: {% if user.profile.monero == '' %}NO ADDRESS{% else %}<a href="{% url 'user-details' user.username %}">Show Full Address</a>{% endif %}<br>
	    XMPP: {% if user.profile.xmppusername == ''  or user.profile.xmppserver == '' %}NO XMPP{% else %}{{user.profile.xmppusername}}@{{user.profile.xmppserver}}{% endif %}<br>
	    FingerPrint: {% if user.profile.fingerprint == '' %}NO FINGERPRINT{% else %}<a href="{% url 'user-details' user.username %}">Show Full FingerPrint</a>{% endif %}<br>

	    PGP: {% if user.profile.public_key == '' %}NO KEY{% else %}<a href="{% url 'user-details' user.username %}">Show Full Key</a>{% endif %}<br><br>

	    <a class="btn-primary btn-lg" style="text-decoration: inherit; color: inherit;" href="#">collapse</a>    
	</p>
</div>
<div class="post-list">
	{% if request.user == user %}
		<center>
    		<a class="btn btn-primary" style="width: 100%; margin-bottom: 10px;" href="#createapost">Create A Post</a>
	        <div class='post-creation' id="createapost">
	          <br/>
	          <form method='POST' action="{% url 'post-create' %}">
	            {% csrf_token %}
	            {% if post %}
	            <textarea name="content" class="form-control" style="width: 100%;" cols="100" rows="7" placeholder="Post Human!">{{ content }}</textarea><br/>
	            {% else %}
	            <textarea name="content" class="form-control" style="width: 100%;" cols="100" rows="7" placeholder="Post Human!"></textarea><br/>
	            {% endif %}
	            <button class="btn btn-primary">Post</button>
	            <a href="#" class="btn btn-danger">Cancel</a>
	          </form>
	          <br/>
	        </div>
        </center>
	{% endif %}
	{% for post in posts %}
	<div class="post" style="text-align: left; margin: 0 auto; margin-bottom: 8px;">
	    <div class="picture-containers">
          <img class="profile-picture" src="{{ post.author.profile.image.url }}">  
        </div>
		<div class="post-content">
			<div class="post-info">
				<div class="post-info1">
					<a class="username" href="{% url 'profile' post.author %}">@{{ post.author }}</a>
					<p class="date">{{ post.date_posted }}</p>
				</div>
			</div>

			<a style="text-decoration: inherit; color: inherit;" href="{% url 'post-detail' post.pk %}">
				<div class="post-text text-wrap text-break" style="width: 100%;">
					<p>{{ post.content|convert_markdown|safe }}</p>
					<a style="width: 40%; height: 35%;" href="{% url 'post-detail' post.pk %}" class="btn btn-outline-info">Open Post</a>
				</div>
		   </a>
		</div>
	</div>
	{% endfor %}
</div>
<br>
<center>
	<br/>
	{% if postscount == 0 %}
		<h2>I'm Bored!!</h2>
	{% else %}
        {% if posts.has_previous %}
            <a href="?page={{posts.previous_page_number}}" class="btn btn-outline-info"><</a>
        {% endif %}
        {% if not posts.has_previous and not posts.has_next %}
		{% else %}
	        <span class="btn btn-primary">{{posts.number}}</span>
        {% endif %}
        {% if posts.has_next %}
            <a href="?page={{posts.next_page_number}}" class="btn btn-outline-info">></a>
        {% endif %}
    {% endif %}
</center>
{% endblock content %}