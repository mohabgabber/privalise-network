{% extends 'posts/base.html' %}
{% load post_extras %}
{% block title %}Privalise!, Where Everything Is Awesome{% endblock title %}
{% block content %}
	<main class="container-fluid mx-auto content">
		<div class="mx-auto logo-text">
		  <div>Priva<span>Lise</span></div>
		</div>
	  {% if messages %}
	     {% for message in messages %}
	        <div class="alert alert-{{ message.tags }} content">{{ message }}</div>
	     {% endfor %}
	  {% endif %}
	  	<br/>
	    <div class="container post-list">
	    	<center>
	    		<a class="btn btn-primary" style="width: 100%; margin-bottom: 10px;" href="#createapost">Create A Post</a>
		        <div class='post-creation' id="createapost">
		          <br/>
		          <form method='POST' action="{% url 'post-create' %}">
		            {% csrf_token %}
		            <textarea name="content" class="form-control" style="width: 100%;" cols="100" rows="7" placeholder="Post Human!"></textarea><br/>
		            <button class="btn btn-primary">Post</button>
		            <a href="#" class="btn btn-danger">Cancel</a>
		          </form>
		          <br/>
		        </div>
	        </center>
			{% for post in posts %}
				<div class="post" style="text-align: left;  margin: 0 auto; margin-bottom: 8px;">
						<div class="picture-containers">
				        <img class="profile-picture post-img" src="{{ post.author.profile.image.url }}">
						</div>
					<div class="profile-container">
				    </div>

					<div class="post-content">
						<div class="post-info">
							<div class="post-info1">
								<a class="username" href="{% url 'profile' post.author %}">@{{ post.author }}</a>
								<p class="date">{{ post.date_posted }}</p>
							</div>
	    			    </div>

						<a style="text-decoration: inherit; color: inherit;" href="{% url 'post-detail' post.pk %}">
							<div class="post-text" style="width: 50%;">
								<p>{{ post.content|convert_markdown|safe }}</p>
								{% if request.user == post.author %}
					                <button class="btn btn-primary">{{post.likes.count}} Upvotes</button>
					                <div class="dropdown" style="margin-bottom: 6px;">
					                  <button class="btn btn-outline-info">Actions</button>
					                    <div class="dropdown-content">
					                        <a href="#confirmdeletepost">Delete</a>
					                        <a href="#editpost">Edit</a>
					                        <a href="#sharepost">Share</a>
					                    </div>
					                    <br>
					                </div>
					                <p id="confirmdeletepost">
					                <a style="margin-top: 5px;" href="{% url 'post-delete' post.id %}" class="btn btn-danger">
					                  Confirm Delete
					                </a>
					                    <a href="#" style="margin-left: 5px; margin-top: 5px;"  class="btn btn-primary">
					                        Safe My Post
					                    </a>
					                </p>
					                <p id="sharepost">
					                    <a class="btn btn-outline-info" href="{% url 'post-detail' post.id %}">Copy This</a>
					                    <a class="btn btn-outline-danger" href="#">Done</a>
					                </p>
					                <div id="editpost">
						                <form method="POST" action="{% url 'post-update' post.id %}">
						                  {% csrf_token %}
						                  <textarea name="content" class="form-control" style="width: 100%; margin-bottom: 6px;" cols="10" rows="7" placeholder="Post Human!">{{post.content}}</textarea>
						                  <button type="submit" class="btn btn-primary">
						                    Publish
						                  </button>
						                  <a href="#" style="margin-left: 5px;"  class="btn btn-primary">
						                    Cancel
						                  </a>
						                </form>
					                </div>
					            {% else %}
					                <a style="width: 60px; height: 35%;" href="{% url 'add-like' post.id %}" class="btn btn-primary"><i class="fas fa-kiss-wink-heart"></i></a>
					                <button class="btn btn-outline-info" style="margin: 5px;">{{ post.likes.count }}</button>
					                <a style="width: 60px; height: 35%;" href="{% url 'add-dislike' post.id %}" class="btn btn-danger"><i class="fas fa-hand-middle-finger"></i></a>
									<a style="width: 40%; height: 35%;" href="{% url 'post-detail' post.pk %}" class="btn btn-outline-info">Open Post</a>
					            {% endif %}
							</div>
					   </a>
					</div>
				</div>
			{% endfor %}
		</div>
		<center>
		{% if postscount == 0 %}
		<h2>I'm So Lonely Right Now!!, Just Follow Someone Already, Damn it.</h2>
		{% else %}
			{% if posts.has_previous %}
			    <a href="?page={{posts.previous_page_number}}" class="btn btn-outline-info"><</a>
			{% endif %}
			{% if not posts.has_previous and not posts.has_next %}
			{% else %}
				<span class="btn btn-primary">{{posts.number}}</span>  
			{% endif %}
			
			{% if posts.has_next %}
			    <a href="?page={{posts.next_page_number}}" class="btn btn-outline-info">></a>
			{% endif %}
		{% endif %}
		</center>
{% endblock content %}